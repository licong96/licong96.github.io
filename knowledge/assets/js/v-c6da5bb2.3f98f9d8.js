"use strict";(self.webpackChunkknowledge=self.webpackChunkknowledge||[]).push([[5923],{4279:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-c6da5bb2",path:"/computers/backend-developer/node/blogs.html",title:"Web Blogs 案例介绍",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"流程图",slug:"流程图",children:[]},{level:2,title:"目标",slug:"目标",children:[]},{level:2,title:"需求",slug:"需求",children:[]},{level:2,title:"技术方案",slug:"技术方案",children:[]},{level:2,title:"存储用户数据",slug:"存储用户数据",children:[]},{level:2,title:"接口设计",slug:"接口设计",children:[{level:3,title:"开发接口",slug:"开发接口",children:[]},{level:3,title:"处理路由",slug:"处理路由",children:[]}]},{level:2,title:"登录",slug:"登录",children:[{level:3,title:"Cookie",slug:"cookie",children:[]},{level:3,title:"Redis",slug:"redis",children:[]},{level:3,title:"Nodejs链接Redis",slug:"nodejs链接redis",children:[]},{level:3,title:"开发登录功能，和前端联调",slug:"开发登录功能-和前端联调",children:[]}]},{level:2,title:"Nginx",slug:"nginx",children:[]},{level:2,title:"处理http请求",slug:"处理http请求",children:[{level:3,title:"处理GET请求",slug:"处理get请求",children:[]},{level:3,title:"处理POST请求",slug:"处理post请求",children:[]},{level:3,title:"搭建开发环境",slug:"搭建开发环境",children:[]}]},{level:2,title:"连接数据库",slug:"连接数据库",children:[{level:3,title:"操作数据库",slug:"操作数据库",children:[]},{level:3,title:"区分环境配置",slug:"区分环境配置",children:[]}]},{level:2,title:"PM2",slug:"pm2",children:[{level:3,title:"常用命令",slug:"常用命令",children:[]},{level:3,title:"配置文件",slug:"配置文件",children:[]}]},{level:2,title:"日志",slug:"日志",children:[{level:3,title:"nodejs文件操作",slug:"nodejs文件操作",children:[]}]},{level:2,title:"安全",slug:"安全",children:[]},{level:2,title:"express 框架",slug:"express-框架",children:[{level:3,title:"中间件",slug:"中间件",children:[]}]},{level:2,title:"Koa2 框架",slug:"koa2-框架",children:[{level:3,title:"async/await 要点",slug:"async-await-要点",children:[]},{level:3,title:"洋葱圈模型",slug:"洋葱圈模型",children:[]}]}],filePathRelative:"computers/backend-developer/node/blogs.md",git:{updatedTime:1639115274e3,contributors:[{name:"黎聪",email:"licong23@xdf.cn",commits:5}]}}},7512:(n,s,a)=>{a.r(s),a.d(s,{default:()=>ns});var t=a(6252);const l=a.p+"assets/img/flow-chart.faf3d619.png",e=(0,t.Wm)("h1",{id:"web-blogs-案例介绍",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#web-blogs-案例介绍","aria-hidden":"true"},"#"),(0,t.Uk)(" Web Blogs 案例介绍")],-1),m=(0,t.Wm)("blockquote",null,[(0,t.Wm)("p",null,"Node.js从零开发 Web Server博客项目 前端晋升全栈工程师必备")],-1),o=(0,t.Wm)("h2",{id:"流程图",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#流程图","aria-hidden":"true"},"#"),(0,t.Uk)(" 流程图")],-1),c=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:l,alt:"image"})],-1),u=(0,t.Wm)("h2",{id:"目标",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#目标","aria-hidden":"true"},"#"),(0,t.Uk)(" 目标")],-1),p=(0,t.Wm)("p",null,"开发一个博客系统，具有博客的基本功能。",-1),W=(0,t.Wm)("h2",{id:"需求",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#需求","aria-hidden":"true"},"#"),(0,t.Uk)(" 需求")],-1),i=(0,t.Wm)("p",null,"需求指导开发。",-1),r=(0,t.Wm)("h2",{id:"技术方案",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#技术方案","aria-hidden":"true"},"#"),(0,t.Uk)(" 技术方案")],-1),k=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"数据如何存储。"),(0,t.Wm)("li",null,"如何与前端对接，接口设计。")],-1),d=(0,t.Wm)("h2",{id:"存储用户数据",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#存储用户数据","aria-hidden":"true"},"#"),(0,t.Uk)(" 存储用户数据")],-1),U=(0,t.Wm)("h2",{id:"接口设计",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#接口设计","aria-hidden":"true"},"#"),(0,t.Uk)(" 接口设计")],-1),b=(0,t.Wm)("h3",{id:"开发接口",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#开发接口","aria-hidden":"true"},"#"),(0,t.Uk)(" 开发接口")],-1),h=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"暂时不连接数据库，先模拟数据，写出接口")]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"初始化路由：根据之前技术方案的设计，做出路由")]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"返回假数据：将路由和数据处理分离，以符合设计原则")])],-1),g=(0,t.Wm)("h3",{id:"处理路由",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理路由","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理路由")],-1),f=(0,t.Wm)("div",{class:"custom-container tip"},[(0,t.Wm)("p",{class:"custom-container-title"},"API和路由"),(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"API")]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"前端和后端，不同端（子系统）对接的一个术语"),(0,t.Wm)("li",null,"有url(路由)，有输入，有输出")]),(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"路由")]),(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"是API的一部分"),(0,t.Wm)("li",null,"后端系统内部的一个定义")])],-1),v=(0,t.Wm)("h2",{id:"登录",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#登录","aria-hidden":"true"},"#"),(0,t.Uk)(" 登录")],-1),x=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"登录校验&登录信息存储"),(0,t.Wm)("li",null,"Cookie和Session"),(0,t.Wm)("li",null,"Session写入Redis"),(0,t.Wm)("li",null,"开发登录功能，和前端联调")],-1),y=(0,t.Wm)("h3",{id:"cookie",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#cookie","aria-hidden":"true"},"#"),(0,t.Uk)(" Cookie")],-1),w=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"客户端操作Cookie")]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"Server端操作Cookie: Set-Cookie")]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,[(0,t.Uk)("Server端查看Cookie: "),(0,t.Wm)("code",null,"req.headers.cookie")])]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,[(0,t.Uk)("Server端修改Cookie: "),(0,t.Wm)("code",null,"res.setHeader('Set-Cookie', 'key=val; path=/; httpOnly')")])]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,[(0,t.Uk)("限制客户端修改Cookie: "),(0,t.Wm)("code",null,"httpOnly")])])],-1),j=(0,t.Wm)("h3",{id:"redis",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#redis","aria-hidden":"true"},"#"),(0,t.Uk)(" Redis")],-1),q=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"web server中常用的缓存数据库，数据存放在内存中"),(0,t.Wm)("li",null,"相比mysql，访问速度快"),(0,t.Wm)("li",null,"成本更高，可存储的数据量更小"),(0,t.Wm)("li",null,"解决多进程内存不共享问题，所有进程都访问一个redis服务")],-1),N=(0,t.Wm)("p",null,[(0,t.Uk)("适合存放"),(0,t.Wm)("code",null,"session"),(0,t.Uk)("，因为访问频繁，对性能要求极高。可以不考虑断点丢失数据的问题，登录信息丢失之后可以再去登录。数据量不会太大。")],-1),C=(0,t.Wm)("h3",{id:"nodejs链接redis",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#nodejs链接redis","aria-hidden":"true"},"#"),(0,t.Uk)(" Nodejs链接Redis")],-1),S=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("p",null,[(0,t.Uk)("安装"),(0,t.Wm)("code",null,"redis")])]),(0,t.Wm)("li",null,[(0,t.Wm)("p",null,"使用")])],-1),O=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" redisClient "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redis"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createClient"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"6379"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'127.0.0.1'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nredisClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"on"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'error'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token parameter"},"err"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"error"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 测试"),(0,t.Uk)("\nredisClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'name'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'licong'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" redis"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("print"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nredisClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'name'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" val")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"error"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("val"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token comment"},"// 退出"),(0,t.Uk)("\n\tredisClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"quit"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br")])],-1),_=(0,t.Wm)("h3",{id:"开发登录功能-和前端联调",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#开发登录功能-和前端联调","aria-hidden":"true"},"#"),(0,t.Uk)(" 开发登录功能，和前端联调")],-1),P=(0,t.Wm)("blockquote",null,[(0,t.Wm)("p",null,"用到nginx反向代理")],-1),Y=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"登录功能依赖cookie，必须用浏览器来联调"),(0,t.Wm)("li",null,"cookie跨域不共享，前端和server端必须同域"),(0,t.Wm)("li",null,"需要用到nignx做代理")],-1),I=(0,t.Wm)("h2",{id:"nginx",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#nginx","aria-hidden":"true"},"#"),(0,t.Uk)(" Nginx")],-1),D=(0,t.Uk)("Nginx"),R=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"修改配置：")],-1),T=(0,t.Wm)("p",null,[(0,t.Uk)("配置文件路径: "),(0,t.Wm)("code",null,"nginx-1.20.1 > conf > nginx.conf")],-1),E=(0,t.Wm)("div",{class:"language-conf ext-conf line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-conf"},[(0,t.Wm)("code",null,"server {\n\tlisten       8080;\n\tserver_name  localhost;\n\n\tlocation / {\n\t\tproxy_pass \thttp://localhost:8084;\n\t}\n\n\tlocation /api/ {\n\t\tproxy_pass \thttp://localhost:8000;\n\t\tproxy_set_header \tHost \t$host;\n\t}\n}\n")]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br")])],-1),F=(0,t.Wm)("h2",{id:"处理http请求",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理http请求","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理http请求")],-1),K=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" http "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'http'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" server "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createServer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tres"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"end"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'hello world'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\nserver"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"listen"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"8000"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),A=(0,t.Wm)("h3",{id:"处理get请求",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理get请求","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理"),(0,t.Wm)("code",null,"GET"),(0,t.Uk)("请求")],-1),H=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" server "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createServer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" url "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\treq"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("query "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"parse"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("url"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"split"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'?'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\tres"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"end"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token constant"},"JSON"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"stringify"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("query"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),$=(0,t.Wm)("h3",{id:"处理post请求",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#处理post请求","aria-hidden":"true"},"#"),(0,t.Uk)(" 处理"),(0,t.Wm)("code",null,"POST"),(0,t.Uk)("请求")],-1),B=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" server "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createServer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t.Wm)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'POST'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token comment"},"// 设置返回格式"),(0,t.Uk)("\n\t\tres"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setHeader"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'Content-Type'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'application/json'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token keyword"},"let"),(0,t.Uk)(" postData "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"''"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t\treq"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"on"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'data'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token parameter"},"chunk"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\t\tpostData "),(0,t.Wm)("span",{class:"token operator"},"+="),(0,t.Uk)(" chunk"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t\treq"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"on"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'end'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\t\tres"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"end"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("postData"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br")])],-1),V=(0,t.Wm)("h3",{id:"搭建开发环境",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#搭建开发环境","aria-hidden":"true"},"#"),(0,t.Uk)(" 搭建开发环境")],-1),G=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Uk)("使用"),(0,t.Wm)("code",null,"nodemon"),(0,t.Uk)("监测文件变化，自动重启node")]),(0,t.Wm)("li",null,[(0,t.Uk)("使用"),(0,t.Wm)("code",null,"cross-env"),(0,t.Uk)("设置环境变量，兼容mac、linux、windows")])],-1),L=(0,t.Wm)("h2",{id:"连接数据库",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#连接数据库","aria-hidden":"true"},"#"),(0,t.Uk)(" 连接数据库")],-1),M=(0,t.Wm)("p",null,[(0,t.Uk)("安装"),(0,t.Wm)("code",null,"mysql"),(0,t.Uk)("：")],-1),Q=(0,t.Wm)("div",{class:"language-text ext-text line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-text"},[(0,t.Wm)("code",null,"yarn add mysql\n")]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br")])],-1),X=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"账户: root"),(0,t.Wm)("li",null,"密码: 123456")],-1),Z=(0,t.Wm)("h3",{id:"操作数据库",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#操作数据库","aria-hidden":"true"},"#"),(0,t.Uk)(" 操作数据库")],-1),z=(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,"建库"),(0,t.Wm)("li",null,"建表"),(0,t.Wm)("li",null,"表操作")],-1),J=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"users表：")],-1),nn=(0,t.Wm)("table",null,[(0,t.Wm)("thead",null,[(0,t.Wm)("tr",null,[(0,t.Wm)("th",null,"column"),(0,t.Wm)("th",null,"datatype"),(0,t.Wm)("th",null,"PK"),(0,t.Wm)("th",null,"NN"),(0,t.Wm)("th",null,"UQ"),(0,t.Wm)("th",null,"B"),(0,t.Wm)("th",null,"UN"),(0,t.Wm)("th",null,"ZF"),(0,t.Wm)("th",null,"AI"),(0,t.Wm)("th",null,"Default")])]),(0,t.Wm)("tbody",null,[(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"id"),(0,t.Wm)("td",null,"int"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"username"),(0,t.Wm)("td",null,"varchar(20)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"password"),(0,t.Wm)("td",null,"varchar(20)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"realname"),(0,t.Wm)("td",null,"varchar(10)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")])])],-1),sn=(0,t.Wm)("p",null,[(0,t.Wm)("strong",null,"blogs表：")],-1),an=(0,t.Wm)("table",null,[(0,t.Wm)("thead",null,[(0,t.Wm)("tr",null,[(0,t.Wm)("th",null,"column"),(0,t.Wm)("th",null,"datatype"),(0,t.Wm)("th",null,"PK"),(0,t.Wm)("th",null,"NN"),(0,t.Wm)("th",null,"UQ"),(0,t.Wm)("th",null,"B"),(0,t.Wm)("th",null,"UN"),(0,t.Wm)("th",null,"ZF"),(0,t.Wm)("th",null,"AI"),(0,t.Wm)("th",null,"Default")])]),(0,t.Wm)("tbody",null,[(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"id"),(0,t.Wm)("td",null,"int"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"title"),(0,t.Wm)("td",null,"varchar(50)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"content"),(0,t.Wm)("td",null,"longtext"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"createtime"),(0,t.Wm)("td",null,"bigint(20)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,"author"),(0,t.Wm)("td",null,"varchar(20)"),(0,t.Wm)("td"),(0,t.Wm)("td",null,"Y"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td"),(0,t.Wm)("td")])])],-1),tn=(0,t.Wm)("h3",{id:"区分环境配置",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#区分环境配置","aria-hidden":"true"},"#"),(0,t.Uk)(" 区分环境配置")],-1),ln=(0,t.Wm)("p",null,"process.env.NODE_ENV",-1),en=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"NODE_ENV=dev"),(0,t.Wm)("li",null,"NODE_ENV=production")],-1),mn=(0,t.Wm)("h2",{id:"pm2",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#pm2","aria-hidden":"true"},"#"),(0,t.Uk)(" PM2")],-1),on=(0,t.Uk)("官网："),cn={href:"https://pm2.keymetrics.io/docs/usage/quick-start/",target:"_blank",rel:"noopener noreferrer"},un=(0,t.Uk)("https://pm2.keymetrics.io/docs/usage/quick-start/"),pn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"进程守护，系统崩溃自动重启"),(0,t.Wm)("li",null,"启动多进程，充分利用CPU和内存"),(0,t.Wm)("li",null,"自带日志记录功能")],-1),Wn=(0,t.Wm)("h3",{id:"常用命令",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#常用命令","aria-hidden":"true"},"#"),(0,t.Uk)(" 常用命令")],-1),rn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Uk)("运行 "),(0,t.Wm)("code",null,"pm2 start app.js")]),(0,t.Wm)("li",null,[(0,t.Uk)("查看 "),(0,t.Wm)("code",null,"pm2 list")]),(0,t.Wm)("li",null,[(0,t.Uk)("重启 "),(0,t.Wm)("code",null,"pm2 restart [0]")]),(0,t.Wm)("li",null,[(0,t.Uk)("停止 "),(0,t.Wm)("code",null,"pm2 stop [0]")]),(0,t.Wm)("li",null,[(0,t.Uk)("信息 "),(0,t.Wm)("code",null,"pm2 info [0]")]),(0,t.Wm)("li",null,[(0,t.Uk)("日志 "),(0,t.Wm)("code",null,"pm2 log")])],-1),kn=(0,t.Wm)("h3",{id:"配置文件",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#配置文件","aria-hidden":"true"},"#"),(0,t.Uk)(" 配置文件")],-1),dn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"设置进程数量"),(0,t.Wm)("li",null,"修改日志文件地址")],-1),Un=(0,t.Wm)("h2",{id:"日志",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#日志","aria-hidden":"true"},"#"),(0,t.Uk)(" 日志")],-1),bn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"访问日志"),(0,t.Wm)("li",null,"自定义日志"),(0,t.Wm)("li",null,"nodejs文件操作 nodejs stream"),(0,t.Wm)("li",null,"日志功能开发和使用"),(0,t.Wm)("li",null,"日志文件拆分，日志内容分析")],-1),hn=(0,t.Wm)("h3",{id:"nodejs文件操作",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#nodejs文件操作","aria-hidden":"true"},"#"),(0,t.Uk)(" nodejs文件操作")],-1),gn=(0,t.Wm)("p",null,"写入文件:",-1),fn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" fs "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'fs'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" fileName "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'test.txt'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" content "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'\\n这是新写入的内容'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" opt "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tflag"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'a'"),(0,t.Uk)("\t"),(0,t.Wm)("span",{class:"token comment"},"// a: 追加写入，w: 覆盖写入"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nfs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"writeFile"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("fileName"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" content"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" opt"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br")])],-1),vn=(0,t.Wm)("p",null,"读取文件：",-1),xn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" fs "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'fs'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" path "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'path'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" fileName "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"resolve"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'test.txt'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nfs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"readFile"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("fileName"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" data")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t\t"),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\t"),(0,t.Wm)("span",{class:"token comment"},"// data 是二进制类型，需要转为字符串"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br")])],-1),yn=(0,t.Wm)("h4",{id:"i-o操作的性能瓶颈",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#i-o操作的性能瓶颈","aria-hidden":"true"},"#"),(0,t.Uk)(" I/O操作的性能瓶颈")],-1),wn=(0,t.Wm)("blockquote",null,[(0,t.Wm)("p",null,"I/O是input/output的意思，就是输入输出操作。")],-1),jn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Uk)("I/O包括"),(0,t.Wm)("code",null,"网络I/O"),(0,t.Uk)("和"),(0,t.Wm)("code",null,"文件I/O")]),(0,t.Wm)("li",null,"相比于CPU计算和内存读写，比较慢"),(0,t.Wm)("li",null,"要在有限的硬件资源下，提高I/O的操作效率"),(0,t.Wm)("li",null,"使用stream")],-1),qn=(0,t.Wm)("h4",{id:"stream",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#stream","aria-hidden":"true"},"#"),(0,t.Uk)(" stream")],-1),Nn=(0,t.Wm)("blockquote",null,[(0,t.Wm)("p",null,"管道")],-1),Cn=(0,t.Wm)("p",null,"解决网络和文件的读写效率问题",-1),Sn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"拷贝文件"),(0,t.Wm)("li",null,"网络返回")],-1),On=(0,t.Wm)("h4",{id:"写日志",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#写日志","aria-hidden":"true"},"#"),(0,t.Uk)(" 写日志")],-1),_n=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" fullFileName "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"join"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'../'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'../'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'logs'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" fileName"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" writeStream "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createWriteStream"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("fullFileName"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tflags"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'a'"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nwriteStream"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"write"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("log "),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'\\n'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),Pn=(0,t.Wm)("h4",{id:"拆分日志",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#拆分日志","aria-hidden":"true"},"#"),(0,t.Uk)(" 拆分日志")],-1),Yn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"按时间拆分"),(0,t.Wm)("li",null,[(0,t.Uk)("实现方式："),(0,t.Wm)("code",null,"linux"),(0,t.Uk)("的"),(0,t.Wm)("code",null,"crontab"),(0,t.Uk)("命令，即定时任务")])],-1),In=(0,t.Wm)("h2",{id:"安全",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#安全","aria-hidden":"true"},"#"),(0,t.Uk)(" 安全")],-1),Dn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"sql注入"),(0,t.Wm)("li",null,"xss攻击"),(0,t.Wm)("li",null,"用户密码加密（md5）")],-1),Rn=(0,t.Wm)("h2",{id:"express-框架",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#express-框架","aria-hidden":"true"},"#"),(0,t.Uk)(" express 框架")],-1),Tn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"脚手架工具"),(0,t.Wm)("li",null,"中间件机制"),(0,t.Wm)("li",null,"开发接口，连接数据库，实现登录，日志记录"),(0,t.Wm)("li",null,"中间件原理")],-1),En=(0,t.Wm)("h3",{id:"中间件",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#中间件","aria-hidden":"true"},"#"),(0,t.Uk)(" 中间件")],-1),Fn=(0,t.Wm)("p",null,[(0,t.Uk)("每一个在"),(0,t.Wm)("code",null,"app.use"),(0,t.Uk)("中注册的函数都是中间件。")],-1),Kn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"next()")],-1),An=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"app.use"),(0,t.Uk)("如果第一个参数是函数，会直接执行。运行"),(0,t.Wm)("code",null,"next()"),(0,t.Uk)("会执行下一个符合要求的"),(0,t.Wm)("code",null,"app.use"),(0,t.Uk)("中注册的函数，包括满足条件的父路由里面的函数也会执行；不执行"),(0,t.Wm)("code",null,"next()"),(0,t.Uk)("下面的就不会执行。")],-1),Hn=(0,t.Wm)("p",null,"满足条件：",-1),$n=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"请求方式"),(0,t.Wm)("li",null,"路由地址")],-1),Bn=(0,t.Wm)("p",null,"路由条件：",-1),Vn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"app.use('/api')"),(0,t.Uk)("，get和post都能匹配")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"app.get('/api')"),(0,t.Uk)("，只匹配get")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"app.post('/api')"),(0,t.Uk)("，只匹配post")])],-1),Gn=(0,t.Wm)("p",null,[(0,t.Wm)("em",null,[(0,t.Wm)("strong",null,"中间件原理")])],-1),Ln=(0,t.Wm)("h2",{id:"koa2-框架",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#koa2-框架","aria-hidden":"true"},"#"),(0,t.Uk)(" Koa2 框架")],-1),Mn=(0,t.Wm)("h3",{id:"async-await-要点",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#async-await-要点","aria-hidden":"true"},"#"),(0,t.Uk)(" async/await 要点")],-1),Qn=(0,t.Wm)("ol",null,[(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"await"),(0,t.Uk)("后面可以追加"),(0,t.Wm)("code",null,"promise"),(0,t.Uk)("对象，获取"),(0,t.Wm)("code",null,"resolve"),(0,t.Uk)("的值")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"await"),(0,t.Uk)("必须包裹在"),(0,t.Wm)("code",null,"async"),(0,t.Uk)("函数中")]),(0,t.Wm)("li",null,[(0,t.Wm)("code",null,"async"),(0,t.Uk)("函数执行返回的也是一个"),(0,t.Wm)("code",null,"promise"),(0,t.Uk)("对象")]),(0,t.Wm)("li",null,[(0,t.Uk)("try-catch可以截获"),(0,t.Wm)("code",null,"promise"),(0,t.Uk)("中"),(0,t.Wm)("code",null,"reject"),(0,t.Uk)("的值")])],-1),Xn=(0,t.Wm)("h3",{id:"洋葱圈模型",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#洋葱圈模型","aria-hidden":"true"},"#"),(0,t.Uk)(" 洋葱圈模型")],-1),Zn=(0,t.Wm)("p",null,[(0,t.Uk)("一个"),(0,t.Wm)("code",null,"request"),(0,t.Uk)("从进入到"),(0,t.Wm)("code",null,"response"),(0,t.Uk)("的过程，一层一层进入，再一层一层出来。")],-1),zn=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Uk)("处理过程"),(0,t.Wm)("code",null,"next()"),(0,t.Uk)("：第一层，开始 -> 第二层，开始 -> 第三层，开始 -> 第三层，结束 -> 第二层，结束 -> 第一层，结束")])],-1),Jn=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" Koa "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"require"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'koa'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" app "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Koa"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// logger"),(0,t.Uk)("\n\napp"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"use"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第一层，开始'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" rt "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" ctx"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("response"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'X-Response-Time'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  console"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token template-string"},[(0,t.Wm)("span",{class:"token template-punctuation string"},"`"),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("ctx"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token string"}," "),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("ctx"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token string"}," - "),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("rt"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token template-punctuation string"},"`")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第一层，结束'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// x-response-time"),(0,t.Uk)("\n\napp"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"use"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第二层，开始'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" start "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Date"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"now"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"next"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" ms "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" Date"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"now"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)(" start"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  ctx"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'X-Response-Time'"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token template-string"},[(0,t.Wm)("span",{class:"token template-punctuation string"},"`"),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("ms"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token string"},"ms"),(0,t.Wm)("span",{class:"token template-punctuation string"},"`")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第二层，结束'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// response"),(0,t.Uk)("\n\napp"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"use"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token parameter"},"ctx"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第二层，开始'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  ctx"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("body "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Hello World'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\tconsole"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"log"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'第二层，结束'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\napp"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"listen"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"3000"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"26"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"27"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"28"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"29"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"30"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"31"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"32"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"33"),(0,t.Wm)("br")])],-1),ns={render:function(n,s){const a=(0,t.up)("RouterLink"),l=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.j4)(t.HY,null,[e,m,o,c,u,p,W,i,r,k,d,U,b,h,g,f,v,x,y,w,j,q,N,C,S,O,_,P,Y,I,(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,[(0,t.Wm)(a,{to:"/computers/backend-developer/Nginx.html"},{default:(0,t.w5)((()=>[D])),_:1})])]),R,T,E,F,K,A,H,$,B,V,G,L,M,Q,X,Z,z,J,nn,sn,an,tn,ln,en,mn,(0,t.Wm)("p",null,[on,(0,t.Wm)("a",cn,[un,(0,t.Wm)(l)])]),pn,Wn,rn,kn,dn,Un,bn,hn,gn,fn,vn,xn,yn,wn,jn,qn,Nn,Cn,Sn,On,_n,Pn,Yn,In,Dn,Rn,Tn,En,Fn,Kn,An,Hn,$n,Bn,Vn,Gn,Ln,Mn,Qn,Xn,Zn,zn,Jn],64)}}}}]);